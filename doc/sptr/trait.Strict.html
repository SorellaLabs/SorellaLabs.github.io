<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `Strict` trait in crate `sptr`."><title>Strict in sptr - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-5bc39a1768837dd0.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="sptr" data-themes="" data-resource-suffix="" data-rustdoc-version="1.78.0-nightly (b11fbfbf3 2024-02-03)" data-channel="nightly" data-search-js="search-dd67cee4cfa65049.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-4c98445ec4002617.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-48f368f3872407c8.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-04d5337699b92874.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../sptr/index.html">sptr</a><span class="version">0.3.2</span></h2></div><h2 class="location"><a href="#">Strict</a></h2><div class="sidebar-elems"><section><h3><a href="#required-associated-types">Required Associated Types</a></h3><ul class="block"><li><a href="#associatedtype.Pointee">Pointee</a></li></ul><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.addr">addr</a></li><li><a href="#tymethod.expose_addr">expose_addr</a></li><li><a href="#tymethod.map_addr">map_addr</a></li><li><a href="#tymethod.with_addr">with_addr</a></li></ul><h3><a href="#foreign-impls">Implementations on Foreign Types</a></h3><ul class="block"><li><a href="#impl-Strict-for-*const+T">*const T</a></li><li><a href="#impl-Strict-for-*mut+T">*mut T</a></li></ul><h3><a href="#object-safety">Object Safety</a></h3><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In crate sptr</a></h2></div></nav><div class="sidebar-resizer"></div>
    <main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><div id="sidebar-button" tabindex="-1"><a href="../sptr/all.html" title="show sidebar"></a></div><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" tabindex="-1"><a href="../help.html" title="help">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="index.html">sptr</a>::<wbr><a class="trait" href="#">Strict</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/sptr/lib.rs.html#504-592">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait Strict: Sealed {
    type <a href="#associatedtype.Pointee" class="associatedtype">Pointee</a>;

    // Required methods
    fn <a href="#tymethod.addr" class="fn">addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>
       <span class="where">where Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.expose_addr" class="fn">expose_addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>
       <span class="where">where Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.with_addr" class="fn">with_addr</a>(self, addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self
       <span class="where">where Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.map_addr" class="fn">map_addr</a>(self, f: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self
       <span class="where">where Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a></span>;
}</code></pre><h2 id="required-associated-types" class="section-header">Required Associated Types<a href="#required-associated-types" class="anchor">§</a></h2><div class="methods"><section id="associatedtype.Pointee" class="method"><a class="src rightside" href="../src/sptr/lib.rs.html#505">source</a><h4 class="code-header">type <a href="#associatedtype.Pointee" class="associatedtype">Pointee</a></h4></section></div><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.addr" class="method"><a class="src rightside" href="../src/sptr/lib.rs.html#530-532">source</a><h4 class="code-header">fn <a href="#tymethod.addr" class="fn">addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></summary><div class="docblock"><p>Gets the “address” portion of the pointer.</p>
<p>This is similar to <code>self as usize</code>, which semantically discards <em>provenance</em> and
<em>address-space</em> information. However, unlike <code>self as usize</code>, casting the returned address
back to a pointer yields <a href="fn.invalid.html" title="fn sptr::invalid"><code>invalid</code></a>, which is undefined behavior to dereference. To
properly restore the lost information and obtain a dereferencable pointer, use
<a href="trait.Strict.html#tymethod.with_addr" title="method sptr::Strict::with_addr"><code>with_addr</code></a> or <a href="trait.Strict.html#tymethod.map_addr" title="method sptr::Strict::map_addr"><code>map_addr</code></a>.</p>
<p>If using those APIs is not possible because there is no way to preserve a pointer with the
required provenance, use <a href="trait.Strict.html#tymethod.expose_addr" title="method sptr::Strict::expose_addr"><code>expose_addr</code></a> and
<a href="fn.from_exposed_addr.html" title="fn sptr::from_exposed_addr"><code>from_exposed_addr</code></a> instead. However, note that this makes
your code less portable and less amenable to tools that check for compliance with the Rust
memory model.</p>
<p>On most platforms this will produce a value with the same bytes as the original
pointer, because all the bytes are dedicated to describing the address.
Platforms which need to store additional information in the pointer may
perform a change of representation to produce a value containing only the address
portion of the pointer. What that means is up to the platform to define.</p>
<p>This API and its claimed semantics are part of the Strict Provenance experiment, and as such
might change in the future (including possibly weakening this so it becomes wholly
equivalent to <code>self as usize</code>). See the <a href="index.html" title="mod sptr">module documentation</a> for details.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.expose_addr" class="method"><a class="src rightside" href="../src/sptr/lib.rs.html#559-561">source</a><h4 class="code-header">fn <a href="#tymethod.expose_addr" class="fn">expose_addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></summary><div class="docblock"><p>Gets the “address” portion of the pointer, and ‘exposes’ the “provenance” part for future
use in <a href="fn.from_exposed_addr.html" title="fn sptr::from_exposed_addr"><code>from_exposed_addr</code></a>.</p>
<p>This is equivalent to <code>self as usize</code>, which semantically discards <em>provenance</em> and
<em>address-space</em> information. Furthermore, this (like the <code>as</code> cast) has the implicit
side-effect of marking the provenance as ‘exposed’, so on platforms that support it you can
later call <a href="fn.from_exposed_addr.html" title="fn sptr::from_exposed_addr"><code>from_exposed_addr</code></a> to reconstitute the original pointer including its
provenance. (Reconstructing address space information, if required, is your responsibility.)</p>
<p>Using this method means that code is <em>not</em> following Strict Provenance rules. Supporting
<a href="fn.from_exposed_addr.html" title="fn sptr::from_exposed_addr"><code>from_exposed_addr</code></a> complicates specification and reasoning and may not be supported by
tools that help you to stay conformant with the Rust memory model, so it is recommended to
use <a href="trait.Strict.html#tymethod.addr" title="method sptr::Strict::addr"><code>addr</code></a> wherever possible.</p>
<p>On most platforms this will produce a value with the same bytes as the original pointer,
because all the bytes are dedicated to describing the address. Platforms which need to store
additional information in the pointer may not support this operation, since the ‘expose’
side-effect which is required for <a href="fn.from_exposed_addr.html" title="fn sptr::from_exposed_addr"><code>from_exposed_addr</code></a> to work is typically not
available.</p>
<p>This API and its claimed semantics are part of the Strict Provenance experiment, see the
<a href="index.html" title="mod sptr">module documentation</a> for details.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.with_addr" class="method"><a class="src rightside" href="../src/sptr/lib.rs.html#578-580">source</a><h4 class="code-header">fn <a href="#tymethod.with_addr" class="fn">with_addr</a>(self, addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></summary><div class="docblock"><p>Creates a new pointer with the given address.</p>
<p>This performs the same operation as an <code>addr as ptr</code> cast, but copies
the <em>address-space</em> and <em>provenance</em> of <code>self</code> to the new pointer.
This allows us to dynamically preserve and propagate this important
information in a way that is otherwise impossible with a unary cast.</p>
<p>This is equivalent to using <a href="https://doc.rust-lang.org/std/primitive.pointer.html#method.wrapping_offset"><code>wrapping_offset</code></a> to offset
<code>self</code> to the given address, and therefore has all the same capabilities and restrictions.</p>
<p>This API and its claimed semantics are part of the Strict Provenance experiment,
see the <a href="index.html" title="mod sptr">module documentation</a> for details.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.map_addr" class="method"><a class="src rightside" href="../src/sptr/lib.rs.html#589-591">source</a><h4 class="code-header">fn <a href="#tymethod.map_addr" class="fn">map_addr</a>(self, f: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    Self::<a class="associatedtype" href="trait.Strict.html#associatedtype.Pointee" title="type sptr::Strict::Pointee">Pointee</a>: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></summary><div class="docblock"><p>Creates a new pointer by mapping <code>self</code>’s address to a new one.</p>
<p>This is a convenience for <a href="trait.Strict.html#tymethod.with_addr" title="method sptr::Strict::with_addr"><code>with_addr</code></a>, see that method for details.</p>
<p>This API and its claimed semantics are part of the Strict Provenance experiment,
see the <a href="index.html" title="mod sptr">module documentation</a> for details.</p>
</div></details></div><h2 id="object-safety" class="section-header">Object Safety<a href="#object-safety" class="anchor">§</a></h2><div class="object-safety-info">This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#object-safety">object safe</a>.</div><h2 id="foreign-impls" class="section-header">Implementations on Foreign Types<a href="#foreign-impls" class="anchor">§</a></h2><details class="toggle implementors-toggle"><summary><section id="impl-Strict-for-*const+T" class="impl"><a class="src rightside" href="../src/sptr/lib.rs.html#653-707">source</a><a href="#impl-Strict-for-*const+T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="trait.Strict.html" title="trait sptr::Strict">Strict</a> for <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.pointer.html">*const T</a></h3></section></summary><div class="impl-items"><section id="associatedtype.Pointee-1" class="associatedtype trait-impl"><a href="#associatedtype.Pointee-1" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Pointee" class="associatedtype">Pointee</a> = T</h4></section><section id="method.addr" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#658-666">source</a><a href="#method.addr" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.addr" class="fn">addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.expose_addr" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#670-676">source</a><a href="#method.expose_addr" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.expose_addr" class="fn">expose_addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.with_addr" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#680-697">source</a><a href="#method.with_addr" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.with_addr" class="fn">with_addr</a>(self, addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.map_addr" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#701-706">source</a><a href="#method.map_addr" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.map_addr" class="fn">map_addr</a>(self, f: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Strict-for-*mut+T" class="impl"><a class="src rightside" href="../src/sptr/lib.rs.html#597-651">source</a><a href="#impl-Strict-for-*mut+T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="trait.Strict.html" title="trait sptr::Strict">Strict</a> for <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.pointer.html">*mut T</a></h3></section></summary><div class="impl-items"><section id="associatedtype.Pointee-2" class="associatedtype trait-impl"><a href="#associatedtype.Pointee-2" class="anchor">§</a><h4 class="code-header">type <a href="#associatedtype.Pointee" class="associatedtype">Pointee</a> = T</h4></section><section id="method.addr-1" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#602-610">source</a><a href="#method.addr-1" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.addr" class="fn">addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.expose_addr-1" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#614-620">source</a><a href="#method.expose_addr-1" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.expose_addr" class="fn">expose_addr</a>(self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a><div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.with_addr-1" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#624-641">source</a><a href="#method.with_addr-1" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.with_addr" class="fn">with_addr</a>(self, addr: <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section><section id="method.map_addr-1" class="method trait-impl"><a class="src rightside" href="../src/sptr/lib.rs.html#645-650">source</a><a href="#method.map_addr-1" class="anchor">§</a><h4 class="code-header">fn <a href="#tymethod.map_addr" class="fn">map_addr</a>(self, f: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/core/primitive.usize.html">usize</a>) -&gt; Self<div class="where">where
    T: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h4></section></div></details><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"></div><script src="../trait.impl/sptr/trait.Strict.js" data-ignore-extern-crates="core" async></script></section></div></main></body></html>