<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="alloy-dyn-abi"><title>alloy_dyn_abi - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-e883e87179a81222.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="alloy_dyn_abi" data-themes="" data-resource-suffix="" data-rustdoc-version="1.76.0-nightly (de686cbc6 2023-12-14)" data-channel="nightly" data-search-js="search-874d56868bf05518.js" data-settings-js="settings-fe03fdc259827cd2.js" ><script src="../static.files/storage-bc37acceda91d44a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-77dede896d6ac08e.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="icon" href="https://raw.githubusercontent.com/alloy-rs/core/main/assets/favicon.ico"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../alloy_dyn_abi/index.html"><img src="https://raw.githubusercontent.com/alloy-rs/core/main/assets/alloy.jpg" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../alloy_dyn_abi/index.html"><img src="https://raw.githubusercontent.com/alloy-rs/core/main/assets/alloy.jpg" alt="logo"></a><h2><a href="../alloy_dyn_abi/index.html">alloy_dyn_abi</a><span class="version">0.6.0</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">alloy_dyn_abi</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/alloy_dyn_abi/lib.rs.html#10-78">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="alloy-dyn-abi"><a href="#alloy-dyn-abi">alloy-dyn-abi</a></h2>
<p>Dynamic Solidity type encoder.</p>
<p>Run-time representation of Ethereum’s type system with ABI encoding &amp; decoding.</p>
<p>This library provides a runtime encoder/decoder for solidity types. It is
intended to be used when the solidity type is not known at compile time.
This is particularly useful for EIP-712 signing interfaces.</p>
<p>We <strong>strongly</strong> recommend using the <a href="https://docs.rs/alloy-sol-types">static encoder/decoder</a> when possible.
The dynamic encoder/decoder is significantly more expensive, especially for
complex types. It is also significantly more error prone, as the mapping
between solidity types and rust types is not enforced by the compiler.</p>
<h3 id="examples"><a href="#examples">Examples</a></h3>
<p>Basic usage:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>alloy_dyn_abi::{DynSolType, DynSolValue};
<span class="kw">use </span>alloy_primitives::hex;

<span class="comment">// parse a type from a string
// note: eip712 `CustomStruct`s cannot be parsed this way.
</span><span class="kw">let </span>my_type: DynSolType = <span class="string">"uint16[2][]"</span>.parse().unwrap();

<span class="comment">// decode
</span><span class="kw">let </span>my_data = <span class="macro">hex!</span>(
    <span class="string">"0000000000000000000000000000000000000000000000000000000000000020" </span><span class="comment">// offset
    </span><span class="string">"0000000000000000000000000000000000000000000000000000000000000001" </span><span class="comment">// length
    </span><span class="string">"0000000000000000000000000000000000000000000000000000000000000002" </span><span class="comment">// .[0][0]
    </span><span class="string">"0000000000000000000000000000000000000000000000000000000000000003" </span><span class="comment">// .[0][1]
</span>);
<span class="kw">let </span>decoded = my_type.abi_decode(<span class="kw-2">&amp;</span>my_data)<span class="question-mark">?</span>;

<span class="kw">let </span>expected = DynSolValue::Array(<span class="macro">vec!</span>[DynSolValue::FixedArray(<span class="macro">vec!</span>[<span class="number">2u16</span>.into(), <span class="number">3u16</span>.into()])]);
<span class="macro">assert_eq!</span>(decoded, expected);

<span class="comment">// roundtrip
</span><span class="kw">let </span>encoded = decoded.abi_encode();
<span class="macro">assert_eq!</span>(encoded, my_data);</code></pre></div>
<p>EIP-712:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="macro">todo!</span>()</code></pre></div>
<h3 id="how-it-works"><a href="#how-it-works">How it works</a></h3>
<p>The dynamic encoder/decoder is implemented as a set of enums that represent
solidity types, solidity values (in rust representation form), and ABI
tokens. Unlike the static encoder, each of these must be instantiated at
runtime. The <a href="enum.DynSolType.html" title="enum alloy_dyn_abi::DynSolType"><code>DynSolType</code></a> enum represents a solidity type, and is
equivalent to an enum over types implementing the <a href="../alloy_sol_types/types/ty/trait.SolType.html" title="trait alloy_sol_types::types::ty::SolType"><code>crate::SolType</code></a> trait.
The <a href="enum.DynSolValue.html" title="enum alloy_dyn_abi::DynSolValue"><code>DynSolValue</code></a> enum represents a solidity value, and describes the
rust shapes of possible solidity values. It is similar to, but not
equivalent to an enum over types used as <a href="../alloy_sol_types/types/ty/trait.SolType.html#associatedtype.RustType" title="associated type alloy_sol_types::types::ty::SolType::RustType"><code>crate::SolType::RustType</code></a>. The
<a href="enum.DynToken.html" title="enum alloy_dyn_abi::DynToken"><code>DynToken</code></a> enum represents an ABI token, and is equivalent to an enum over
the types implementing the <a href="../alloy_sol_types/abi/token/trait.Token.html" title="trait alloy_sol_types::abi::token::Token"><code>alloy_sol_types::abi::Token</code></a> trait.</p>
<p>Where the static encoding system encodes the expected type information into
the Rust type system, the dynamic encoder/decoder encodes it as a concrete
instance of <a href="enum.DynSolType.html" title="enum alloy_dyn_abi::DynSolType"><code>DynSolType</code></a>.</p>
<ul>
<li>Detokenizing: <code>DynSolType</code> + <code>DynToken</code> = <code>DynSolValue</code></li>
</ul>
<p>Users must manually handle the conversions between <a href="enum.DynSolValue.html" title="enum alloy_dyn_abi::DynSolValue"><code>DynSolValue</code></a> and their
own rust types. We provide several <code>From</code> implementations, but they fall
short when dealing with arrays, tuples and structs. We also provide fallible
casts into the contents of each variant.</p>
<h3 id="dyntokendecode_populate"><a href="#dyntokendecode_populate"><code>DynToken::decode_populate</code></a></h3>
<p>Because the shape of the data is known only at runtime, we cannot
compile-time allocate the memory needed to hold decoded data. Instead, we
pre-allocate a <a href="enum.DynToken.html" title="enum alloy_dyn_abi::DynToken"><code>DynToken</code></a> with the same shape as the expected type, and
empty values. We then populate the empty values with the decoded data.</p>
<p>This is a significant behavior departure from the static decoder. We do not
recommend using the <a href="enum.DynToken.html" title="enum alloy_dyn_abi::DynToken"><code>DynToken</code></a> type directly. Instead, we recommend using
the encoding and decoding methods on <a href="enum.DynSolType.html" title="enum alloy_dyn_abi::DynSolType"><code>DynSolType</code></a>.</p>
<h3 id="licensing"><a href="#licensing">Licensing</a></h3>
<p>This crate is an extensive rewrite of the
<a href="https://github.com/rust-ethereum/ethabi">ethabi</a> crate by the parity team.
That codebase is used under the terms of the <strong>MIT</strong> license. We have preserved
the original license notice in files incorporating <code>ethabi</code> code.</p>
</div></details><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name"><code>pub extern crate <a class="mod" href="../alloy_sol_type_parser/index.html" title="mod alloy_sol_type_parser">alloy_sol_type_parser</a> as parser;</code></div></li><li><div class="item-name" id="reexport.eip712_parser"><code>pub use eip712::<a class="mod" href="eip712/parser/index.html" title="mod alloy_dyn_abi::eip712::parser">parser</a> as eip712_parser;</code></div></li><li><div class="item-name" id="reexport.Eip712Types"><code>pub use eip712::<a class="struct" href="eip712/struct.Eip712Types.html" title="struct alloy_dyn_abi::eip712::Eip712Types">Eip712Types</a>;</code></div></li><li><div class="item-name" id="reexport.PropertyDef"><code>pub use eip712::<a class="struct" href="eip712/struct.PropertyDef.html" title="struct alloy_dyn_abi::eip712::PropertyDef">PropertyDef</a>;</code></div></li><li><div class="item-name" id="reexport.Resolver"><code>pub use eip712::<a class="struct" href="eip712/struct.Resolver.html" title="struct alloy_dyn_abi::eip712::Resolver">Resolver</a>;</code></div></li><li><div class="item-name" id="reexport.TypeDef"><code>pub use eip712::<a class="struct" href="eip712/struct.TypeDef.html" title="struct alloy_dyn_abi::eip712::TypeDef">TypeDef</a>;</code></div></li><li><div class="item-name" id="reexport.TypedData"><code>pub use eip712::<a class="struct" href="eip712/struct.TypedData.html" title="struct alloy_dyn_abi::eip712::TypedData">TypedData</a>;</code></div></li><li><div class="item-name" id="reexport.abi"><code>pub use alloy_sol_types::<a class="mod" href="../alloy_sol_types/abi/index.html" title="mod alloy_sol_types::abi">abi</a>;</code></div></li><li><div class="item-name" id="reexport.Decoder"><code>pub use alloy_sol_types::abi::<a class="struct" href="../alloy_sol_types/abi/decoder/struct.Decoder.html" title="struct alloy_sol_types::abi::decoder::Decoder">Decoder</a>;</code></div></li><li><div class="item-name" id="reexport.Encoder"><code>pub use alloy_sol_types::abi::<a class="struct" href="../alloy_sol_types/abi/encoder/struct.Encoder.html" title="struct alloy_sol_types::abi::encoder::Encoder">Encoder</a>;</code></div></li><li><div class="item-name" id="reexport.Eip712Domain"><code>pub use alloy_sol_types::<a class="struct" href="../alloy_sol_types/eip712/struct.Eip712Domain.html" title="struct alloy_sol_types::eip712::Eip712Domain">Eip712Domain</a>;</code></div></li><li><div class="item-name" id="reexport.SolType"><code>pub use alloy_sol_types::<a class="trait" href="../alloy_sol_types/types/ty/trait.SolType.html" title="trait alloy_sol_types::types::ty::SolType">SolType</a>;</code></div></li><li><div class="item-name" id="reexport.Word"><code>pub use alloy_sol_types::<a class="type" href="../alloy_sol_types/type.Word.html" title="type alloy_sol_types::Word">Word</a>;</code></div></li></ul><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="eip712/index.html" title="mod alloy_dyn_abi::eip712">eip712</a></div><div class="desc docblock-short">Implementation of dynamic EIP-712.</div></li></ul><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.DecodedEvent.html" title="struct alloy_dyn_abi::DecodedEvent">DecodedEvent</a></div><div class="desc docblock-short">A decoded dynamic ABI event.</div></li><li><div class="item-name"><a class="struct" href="struct.DynSolEvent.html" title="struct alloy_dyn_abi::DynSolEvent">DynSolEvent</a></div><div class="desc docblock-short">A dynamic ABI event.</div></li></ul><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.DynSolType.html" title="enum alloy_dyn_abi::DynSolType">DynSolType</a></div><div class="desc docblock-short">A dynamic Solidity type.</div></li><li><div class="item-name"><a class="enum" href="enum.DynSolValue.html" title="enum alloy_dyn_abi::DynSolValue">DynSolValue</a></div><div class="desc docblock-short">A dynamic Solidity value.</div></li><li><div class="item-name"><a class="enum" href="enum.DynToken.html" title="enum alloy_dyn_abi::DynToken">DynToken</a></div><div class="desc docblock-short">A dynamic token.</div></li><li><div class="item-name"><a class="enum" href="enum.Error.html" title="enum alloy_dyn_abi::Error">Error</a></div><div class="desc docblock-short">Error when parsing EIP-712 <code>encodeType</code> strings</div></li></ul><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.EventExt.html" title="trait alloy_dyn_abi::EventExt">EventExt</a></div><div class="desc docblock-short">Provides event encoding and decoding for the <a href="../alloy_json_abi/item/struct.Event.html" title="struct alloy_json_abi::item::Event"><code>Event</code></a> type.</div></li><li><div class="item-name"><a class="trait" href="trait.FunctionExt.html" title="trait alloy_dyn_abi::FunctionExt">FunctionExt</a></div><div class="desc docblock-short">Provide ABI encoding and decoding for the <a href="../alloy_json_abi/item/struct.Function.html" title="struct alloy_json_abi::item::Function"><code>Function</code></a> type.</div></li><li><div class="item-name"><a class="trait" href="trait.JsonAbiExt.html" title="trait alloy_dyn_abi::JsonAbiExt">JsonAbiExt</a></div><div class="desc docblock-short">Provides ABI encoding and decoding functionality.</div></li><li><div class="item-name"><a class="trait" href="trait.ResolveSolEvent.html" title="trait alloy_dyn_abi::ResolveSolEvent">ResolveSolEvent</a></div><div class="desc docblock-short">Resolve a type into a <a href="struct.DynSolEvent.html" title="struct alloy_dyn_abi::DynSolEvent"><code>DynSolEvent</code></a>.</div></li><li><div class="item-name"><a class="trait" href="trait.ResolveSolType.html" title="trait alloy_dyn_abi::ResolveSolType">ResolveSolType</a></div><div class="desc docblock-short">Resolve a type into a <a href="enum.DynSolType.html" title="enum alloy_dyn_abi::DynSolType"><code>DynSolType</code></a>.</div></li></ul><h2 id="types" class="section-header"><a href="#types">Type Aliases</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.Result.html" title="type alloy_dyn_abi::Result">Result</a></div><div class="desc docblock-short">Dynamic ABI result type.</div></li></ul></section></div></main></body></html>